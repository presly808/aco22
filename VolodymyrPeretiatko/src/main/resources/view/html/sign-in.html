<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Sign In | UDairy</title>
    <!--localhost/public/css/style.css-->
    <link rel="stylesheet" type="text/css" href="/view/css/style.css">
</head>

<body>

<div id="touchvpn_icon_container" class="disconnected" draggable="true"
     style="right: 1.99203187% !important; bottom: 2.55102041% !important;">
    <div id="touchvpn_status_icon" class="touchvpn_in">

        <div class="page">
            <h1>UDairy</h1>
            <div class="navigation">

                <a href="/view/html/sign-up.html">sign up</a> |
                <a href="/view/html/sign-in.html">sign in</a>

            </div>

            <div class="body">

                <h2>Sign In</h2>

                <form action="/login" method="post">
                    <dl>
                        <dt>Email:</dt>
                        <dd><input id="email" type="text" name="username" size="30" value=""></dd>
                        <dt>Password:</dt>
                        <dd><input id="pass" type="password" name="password" size="30"></dd>
                    </dl>
                </form>
                <div class="actions"><input id="submitButton" type="submit" value="Sign In"></div>

            </div>
            <div class="footer">
                UDairy
            </div>
        </div>
    </div>
</div>
<script>

  function sendLoginForm(){
    var email = document.getElementById("email").value;
    var pass = document.getElementById("pass").value;

    var obj = { email : email, pass: pass};

    // construct an HTTP request
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "/login", true);
    xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');

    // send the collected data as JSON
    xhr.send(JSON.stringify(obj));

    xhr.onloadend = function (resp) {
      // get access token and put in cookies
      console.log("req has been sucessful\n" + resp);
      window.location.replace("/view/html/user-page.html");
    };

  }

  function init() {
    document.getElementById("submitButton")
      .addEventListener("click", sendLoginForm);
  }
  // add listener to button
  // get form
  // toJson
  // sendToServer

  document.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html>
